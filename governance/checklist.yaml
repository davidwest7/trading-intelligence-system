# Governance and Audit Checklist
# Human-in-loop signoff, policy clocks, exception reviews, auto-reporting packs

version: "1.0"
last_updated: "2024-01-15"
system: "trading-intelligence-system"

# =============================================================================
# PRE-TRADING CHECKS
# =============================================================================

pre_trading_checks:
  data_quality:
    - id: "DQ001"
      name: "Data Completeness Check"
      description: "Verify all required data sources are available and complete"
      required: true
      automated: true
      threshold: 95.0  # Minimum completeness percentage
      check_function: "data_quality.completeness_check"
      reviewer: "data_engineer"
      approval_required: true
      
    - id: "DQ002"
      name: "Data Freshness Check"
      description: "Ensure data is within acceptable latency windows"
      required: true
      automated: true
      threshold: 300  # Maximum latency in seconds
      check_function: "data_quality.freshness_check"
      reviewer: "data_engineer"
      approval_required: false
      
    - id: "DQ003"
      name: "Data Consistency Check"
      description: "Verify data consistency across sources and time periods"
      required: true
      automated: true
      threshold: 0.98  # Minimum consistency score
      check_function: "data_quality.consistency_check"
      reviewer: "data_engineer"
      approval_required: true

  model_validation:
    - id: "MV001"
      name: "Model Performance Validation"
      description: "Verify model performance meets minimum thresholds"
      required: true
      automated: true
      threshold:
        sharpe_ratio: 0.5
        information_ratio: 0.3
        max_drawdown: -0.15
      check_function: "model_validation.performance_check"
      reviewer: "quantitative_researcher"
      approval_required: true
      
    - id: "MV002"
      name: "Model Drift Detection"
      description: "Check for significant model drift or degradation"
      required: true
      automated: true
      threshold:
        psi_score: 0.1
        performance_degradation: 0.05
      check_function: "model_validation.drift_check"
      reviewer: "quantitative_researcher"
      approval_required: true
      
    - id: "MV003"
      name: "Model Calibration Check"
      description: "Verify model calibration and uncertainty estimates"
      required: true
      automated: true
      threshold:
        calibration_score: 0.8
        uncertainty_coverage: 0.95
      check_function: "model_validation.calibration_check"
      reviewer: "quantitative_researcher"
      approval_required: false

  risk_management:
    - id: "RM001"
      name: "Risk Limits Check"
      description: "Verify all risk limits are within acceptable ranges"
      required: true
      automated: true
      threshold:
        var_95: -0.02
        max_position_size: 0.05
        sector_concentration: 0.20
      check_function: "risk_management.limits_check"
      reviewer: "risk_manager"
      approval_required: true
      
    - id: "RM002"
      name: "Crowding Analysis"
      description: "Check for excessive crowding in positions"
      required: true
      automated: true
      threshold:
        crowding_beta: 0.7
        crowding_correlation: 0.6
      check_function: "risk_management.crowding_check"
      reviewer: "risk_manager"
      approval_required: true
      
    - id: "RM003"
      name: "Liquidity Assessment"
      description: "Verify sufficient liquidity for intended positions"
      required: true
      automated: true
      threshold:
        min_adv: 0.01
        max_impact: 0.005
      check_function: "risk_management.liquidity_check"
      reviewer: "risk_manager"
      approval_required: false

# =============================================================================
# TRADING EXECUTION CHECKS
# =============================================================================

trading_execution:
  execution_validation:
    - id: "EV001"
      name: "Order Validation"
      description: "Validate all orders before execution"
      required: true
      automated: true
      check_function: "execution.validation_check"
      reviewer: "trader"
      approval_required: true
      
    - id: "EV002"
      name: "Market Impact Assessment"
      description: "Assess potential market impact of orders"
      required: true
      automated: true
      threshold:
        max_impact: 0.01
        participation_rate: 0.15
      check_function: "execution.impact_assessment"
      reviewer: "trader"
      approval_required: true
      
    - id: "EV003"
      name: "Execution Cost Analysis"
      description: "Analyze expected execution costs"
      required: true
      automated: true
      threshold:
        max_slippage: 0.005
        max_commission: 0.001
      check_function: "execution.cost_analysis"
      reviewer: "trader"
      approval_required: false

  real_time_monitoring:
    - id: "RT001"
      name: "Real-time Performance Monitoring"
      description: "Monitor performance during trading"
      required: true
      automated: true
      frequency: "1min"
      check_function: "monitoring.performance_check"
      reviewer: "trader"
      approval_required: false
      
    - id: "RT002"
      name: "Risk Limit Monitoring"
      description: "Monitor risk limits in real-time"
      required: true
      automated: true
      frequency: "30sec"
      check_function: "monitoring.risk_limits"
      reviewer: "risk_manager"
      approval_required: false
      
    - id: "RT003"
      name: "Market Condition Monitoring"
      description: "Monitor market conditions and regime changes"
      required: true
      automated: true
      frequency: "5min"
      check_function: "monitoring.market_conditions"
      reviewer: "trader"
      approval_required: false

# =============================================================================
# POST-TRADING CHECKS
# =============================================================================

post_trading_checks:
  performance_analysis:
    - id: "PA001"
      name: "Daily Performance Review"
      description: "Review daily trading performance"
      required: true
      automated: false
      frequency: "daily"
      check_function: "performance.daily_review"
      reviewer: "portfolio_manager"
      approval_required: true
      
    - id: "PA002"
      name: "Risk Attribution Analysis"
      description: "Analyze risk attribution and factor contributions"
      required: true
      automated: true
      frequency: "daily"
      check_function: "performance.risk_attribution"
      reviewer: "risk_manager"
      approval_required: false
      
    - id: "PA003"
      name: "Execution Quality Analysis"
      description: "Analyze execution quality and costs"
      required: true
      automated: true
      frequency: "daily"
      check_function: "performance.execution_quality"
      reviewer: "trader"
      approval_required: false

  compliance_checks:
    - id: "CC001"
      name: "Regulatory Compliance Check"
      description: "Verify compliance with regulatory requirements"
      required: true
      automated: true
      frequency: "daily"
      check_function: "compliance.regulatory_check"
      reviewer: "compliance_officer"
      approval_required: true
      
    - id: "CC002"
      name: "Internal Policy Compliance"
      description: "Check compliance with internal trading policies"
      required: true
      automated: true
      frequency: "daily"
      check_function: "compliance.internal_policy"
      reviewer: "compliance_officer"
      approval_required: false
      
    - id: "CC003"
      name: "Documentation Review"
      description: "Review trading documentation and records"
      required: true
      automated: false
      frequency: "daily"
      check_function: "compliance.documentation"
      reviewer: "compliance_officer"
      approval_required: true

# =============================================================================
# POLICY CLOCKS AND TRADING HALTS
# =============================================================================

policy_clocks:
  trading_halts:
    - id: "TH001"
      name: "Market Circuit Breakers"
      description: "Automatic trading halt on market circuit breakers"
      trigger: "market_circuit_breaker"
      action: "halt_trading"
      duration: "market_determined"
      override_required: true
      override_approver: "chief_trading_officer"
      
    - id: "TH002"
      name: "Volatility-Based Halt"
      description: "Trading halt on excessive volatility"
      trigger: "volatility_threshold"
      threshold: 0.05  # 5% daily volatility
      action: "halt_trading"
      duration: "2hours"
      override_required: true
      override_approver: "risk_manager"
      
    - id: "TH003"
      name: "Performance-Based Halt"
      description: "Trading halt on poor performance"
      trigger: "performance_threshold"
      threshold:
        daily_loss: -0.02
        sharpe_ratio: 0.0
      action: "halt_trading"
      duration: "4hours"
      override_required: true
      override_approver: "portfolio_manager"

  review_schedules:
    - id: "RS001"
      name: "Weekly Model Review"
      description: "Weekly review of model performance and parameters"
      frequency: "weekly"
      day: "friday"
      time: "16:00"
      participants: ["quantitative_researcher", "portfolio_manager", "risk_manager"]
      required: true
      
    - id: "RS002"
      name: "Monthly Risk Review"
      description: "Monthly comprehensive risk review"
      frequency: "monthly"
      day: "last_friday"
      time: "14:00"
      participants: ["risk_manager", "chief_risk_officer", "portfolio_manager"]
      required: true
      
    - id: "RS003"
      name: "Quarterly Strategy Review"
      description: "Quarterly strategy performance and allocation review"
      frequency: "quarterly"
      day: "last_friday"
      time: "10:00"
      participants: ["chief_investment_officer", "portfolio_manager", "quantitative_researcher"]
      required: true

# =============================================================================
# EXCEPTION HANDLING
# =============================================================================

exception_handling:
  exception_types:
    - id: "EX001"
      name: "Data Quality Exception"
      description: "Exception due to data quality issues"
      severity: "high"
      auto_resolution: false
      escalation_time: "30min"
      escalation_level: "data_engineer"
      
    - id: "EX002"
      name: "Model Performance Exception"
      description: "Exception due to model performance degradation"
      severity: "critical"
      auto_resolution: false
      escalation_time: "15min"
      escalation_level: "quantitative_researcher"
      
    - id: "EX003"
      name: "Risk Limit Exception"
      description: "Exception due to risk limit breaches"
      severity: "critical"
      auto_resolution: false
      escalation_time: "5min"
      escalation_level: "risk_manager"
      
    - id: "EX004"
      name: "Execution Exception"
      description: "Exception due to execution issues"
      severity: "high"
      auto_resolution: false
      escalation_time: "10min"
      escalation_level: "trader"
      
    - id: "EX005"
      name: "System Exception"
      description: "Exception due to system failures"
      severity: "critical"
      auto_resolution: false
      escalation_time: "5min"
      escalation_level: "system_administrator"

  exception_workflow:
    detection:
      - automated_monitoring: true
      - manual_reporting: true
      - notification_channels: ["email", "slack", "sms"]
      
    triage:
      - severity_assessment: "automated"
      - initial_response_time: "5min"
      - triage_team: ["on_call_engineer", "trading_support"]
      
    resolution:
      - root_cause_analysis: "required"
      - resolution_time_target: "2hours"
      - post_incident_review: "required"
      
    documentation:
      - incident_log: "required"
      - resolution_summary: "required"
      - lessons_learned: "required"

# =============================================================================
# AUTO-REPORTING
# =============================================================================

auto_reporting:
  daily_reports:
    - id: "DR001"
      name: "Daily Performance Report"
      description: "Daily trading performance summary"
      frequency: "daily"
      time: "18:00"
      recipients: ["portfolio_manager", "chief_investment_officer", "risk_manager"]
      format: ["pdf", "email"]
      content:
        - performance_summary
        - risk_metrics
        - position_summary
        - execution_quality
        - compliance_status
      
    - id: "DR002"
      name: "Daily Risk Report"
      description: "Daily risk metrics and limit utilization"
      frequency: "daily"
      time: "17:30"
      recipients: ["risk_manager", "chief_risk_officer"]
      format: ["pdf", "email"]
      content:
        - risk_metrics
        - limit_utilization
        - stress_test_results
        - crowding_analysis
        - liquidity_metrics
      
    - id: "DR003"
      name: "Daily Compliance Report"
      description: "Daily compliance and regulatory status"
      frequency: "daily"
      time: "17:00"
      recipients: ["compliance_officer", "chief_compliance_officer"]
      format: ["pdf", "email"]
      content:
        - regulatory_compliance
        - policy_violations
        - trading_restrictions
        - documentation_status

  weekly_reports:
    - id: "WR001"
      name: "Weekly Model Performance Report"
      description: "Weekly model performance and drift analysis"
      frequency: "weekly"
      day: "friday"
      time: "16:00"
      recipients: ["quantitative_researcher", "portfolio_manager"]
      format: ["pdf", "email"]
      content:
        - model_performance
        - drift_analysis
        - calibration_metrics
        - feature_importance
        - backtest_results
      
    - id: "WR002"
      name: "Weekly Risk Review Report"
      description: "Weekly comprehensive risk review"
      frequency: "weekly"
      day: "friday"
      time: "15:00"
      recipients: ["risk_manager", "chief_risk_officer"]
      format: ["pdf", "email"]
      content:
        - risk_decomposition
        - factor_analysis
        - scenario_analysis
        - limit_effectiveness
        - risk_trends

  monthly_reports:
    - id: "MR001"
      name: "Monthly Performance Report"
      description: "Monthly comprehensive performance analysis"
      frequency: "monthly"
      day: "last_friday"
      time: "14:00"
      recipients: ["chief_investment_officer", "portfolio_manager", "board"]
      format: ["pdf", "presentation"]
      content:
        - performance_attribution
        - risk_adjusted_returns
        - benchmark_comparison
        - strategy_effectiveness
        - capacity_analysis
      
    - id: "MR002"
      name: "Monthly Compliance Report"
      description: "Monthly compliance and regulatory summary"
      frequency: "monthly"
      day: "last_friday"
      time: "13:00"
      recipients: ["chief_compliance_officer", "board"]
      format: ["pdf", "presentation"]
      content:
        - regulatory_compliance_summary
        - policy_violations_summary
        - audit_findings
        - regulatory_changes
        - compliance_metrics

# =============================================================================
# APPROVAL WORKFLOWS
# =============================================================================

approval_workflows:
  model_deployment:
    - stage: "development_complete"
      approver: "quantitative_researcher"
      required: true
      time_limit: "24hours"
      
    - stage: "backtesting_complete"
      approver: "quantitative_researcher"
      required: true
      time_limit: "24hours"
      
    - stage: "risk_assessment"
      approver: "risk_manager"
      required: true
      time_limit: "48hours"
      
    - stage: "compliance_review"
      approver: "compliance_officer"
      required: true
      time_limit: "48hours"
      
    - stage: "final_approval"
      approver: "chief_investment_officer"
      required: true
      time_limit: "72hours"

  risk_limit_changes:
    - stage: "proposal"
      approver: "risk_manager"
      required: true
      time_limit: "24hours"
      
    - stage: "impact_analysis"
      approver: "portfolio_manager"
      required: true
      time_limit: "48hours"
      
    - stage: "final_approval"
      approver: "chief_risk_officer"
      required: true
      time_limit: "72hours"

  trading_restrictions:
    - stage: "identification"
      approver: "compliance_officer"
      required: true
      time_limit: "4hours"
      
    - stage: "risk_assessment"
      approver: "risk_manager"
      required: true
      time_limit: "8hours"
      
    - stage: "final_approval"
      approver: "chief_compliance_officer"
      required: true
      time_limit: "24hours"

# =============================================================================
# AUDIT TRAIL
# =============================================================================

audit_trail:
  required_logs:
    - user_actions: true
    - system_events: true
    - data_access: true
    - model_predictions: true
    - trading_decisions: true
    - risk_calculations: true
    - compliance_checks: true
    
  retention_policy:
    trading_data: "7years"
    model_data: "5years"
    audit_logs: "10years"
    compliance_records: "7years"
    performance_data: "10years"
    
  access_controls:
    - role: "trader"
      permissions: ["view_trading_data", "execute_trades", "view_risk_metrics"]
      
    - role: "risk_manager"
      permissions: ["view_all_data", "modify_risk_limits", "view_audit_logs"]
      
    - role: "compliance_officer"
      permissions: ["view_all_data", "view_audit_logs", "modify_compliance_rules"]
      
    - role: "quantitative_researcher"
      permissions: ["view_model_data", "modify_models", "view_performance_data"]
      
    - role: "system_administrator"
      permissions: ["full_access", "system_configuration", "user_management"]

# =============================================================================
# MONITORING AND ALERTING
# =============================================================================

monitoring_alerting:
  system_health:
    - metric: "system_uptime"
      threshold: 99.9
      alert_level: "critical"
      notification: ["email", "sms"]
      
    - metric: "data_latency"
      threshold: 300  # seconds
      alert_level: "high"
      notification: ["email", "slack"]
      
    - metric: "model_latency"
      threshold: 100  # milliseconds
      alert_level: "medium"
      notification: ["slack"]
      
  performance_alerts:
    - metric: "sharpe_ratio"
      threshold: 0.0
      alert_level: "high"
      notification: ["email", "slack"]
      
    - metric: "max_drawdown"
      threshold: -0.10
      alert_level: "critical"
      notification: ["email", "sms"]
      
    - metric: "information_ratio"
      threshold: 0.0
      alert_level: "high"
      notification: ["email", "slack"]
      
  risk_alerts:
    - metric: "var_95"
      threshold: -0.02
      alert_level: "critical"
      notification: ["email", "sms"]
      
    - metric: "crowding_beta"
      threshold: 0.8
      alert_level: "high"
      notification: ["email", "slack"]
      
    - metric: "liquidity_ratio"
      threshold: 0.1
      alert_level: "medium"
      notification: ["slack"]

# =============================================================================
# COMPLIANCE RULES
# =============================================================================

compliance_rules:
  trading_restrictions:
    - rule: "no_trading_holidays"
      description: "No trading on market holidays"
      enforcement: "automatic"
      
    - rule: "no_trading_after_hours"
      description: "No trading outside market hours"
      enforcement: "automatic"
      
    - rule: "no_trading_restricted_securities"
      description: "No trading in restricted securities"
      enforcement: "automatic"
      
    - rule: "position_size_limits"
      description: "Position size must be within limits"
      enforcement: "automatic"
      
    - rule: "sector_concentration_limits"
      description: "Sector concentration must be within limits"
      enforcement: "automatic"
      
    - rule: "risk_limit_compliance"
      description: "All risk limits must be respected"
      enforcement: "automatic"

  regulatory_compliance:
    - regulation: "SEC_Rule_15c3-5"
      description: "Market Access Rule compliance"
      enforcement: "automatic"
      
    - regulation: "Dodd_Frank_Volcker_Rule"
      description: "Volcker Rule compliance"
      enforcement: "automatic"
      
    - regulation: "MiFID_II"
      description: "MiFID II compliance for EU trading"
      enforcement: "automatic"
      
    - regulation: "Basel_III"
      description: "Basel III capital requirements"
      enforcement: "automatic"

# =============================================================================
# DOCUMENTATION REQUIREMENTS
# =============================================================================

documentation_requirements:
  model_documentation:
    - requirement: "model_specification"
      description: "Complete model specification and methodology"
      frequency: "on_change"
      approver: "quantitative_researcher"
      
    - requirement: "backtest_results"
      description: "Comprehensive backtest results and analysis"
      frequency: "on_change"
      approver: "quantitative_researcher"
      
    - requirement: "risk_assessment"
      description: "Risk assessment and stress testing results"
      frequency: "on_change"
      approver: "risk_manager"
      
    - requirement: "compliance_review"
      description: "Compliance review and regulatory assessment"
      frequency: "on_change"
      approver: "compliance_officer"

  operational_documentation:
    - requirement: "operating_procedures"
      description: "Detailed operating procedures and workflows"
      frequency: "quarterly"
      approver: "operations_manager"
      
    - requirement: "incident_reports"
      description: "Incident reports and resolution summaries"
      frequency: "on_incident"
      approver: "system_administrator"
      
    - requirement: "change_management"
      description: "Change management documentation and approvals"
      frequency: "on_change"
      approver: "change_control_board"
      
    - requirement: "training_materials"
      description: "Training materials and user guides"
      frequency: "annually"
      approver: "training_coordinator"
